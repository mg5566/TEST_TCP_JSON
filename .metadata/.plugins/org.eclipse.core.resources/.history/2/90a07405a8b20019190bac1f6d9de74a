import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.ObjectOutputStream;
import java.net.Socket;
import java.net.*;

public class Client {
	public static void main(String[] args) {

        try {
            // 입력받은 인수가 2개가 아니면 예외 발생 (IP와 PORT)
            if (args.length != 2) throw new IllegalArgumentException("Arguments something wrong");

            String ip = args[0]; // ip
            int port = Integer.parseInt(args[1]); // port

            System.out.println("Server Information : " + ip + " : " + port);

            //서버로 접속 시도를 할 때 서버는 먼저 작동되고 있어야 합니다.
            Socket socket = new Socket(ip, port);

            // ObjectOutputStream()을 이용하여 직렬화를 합니다.
            // socket 통신을 하기 때문에 socket의 stream을 가져옵니다.
            ObjectOutputStream objectOutputStream = new ObjectOutputStream(socket.getOutputStream());

            // Server로부터의 응답을 받기 위한 부분
            // socket 통신을 하기 때문에 socket의 stream을 가져옵니다.
            BufferedReader bufferReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));

            Order order = new Order("Jungwoon", 3, "Chicken");
            objectOutputStream.writeObject(order); // 데이터 직렬화
            objectOutputStream.flush(); // 직렬화된 데이터 전달

            // 서버로부터 메시지 받기 위한 부분
            String returnMessage = bufferReader.readLine();
            System.out.println("returnMessage : " + returnMessage);

            objectOutputStream.close();
            socket.close();
        }
        catch (Exception e) {
            System.err.println("Usage: java Client <hostname> <port:4000>");
            e.printStackTrace();
        }

    }

}
